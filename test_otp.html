<!DOCTYPE html>
<html>
<head>
    <title>Test OTP Inputs</title>
    <style>
        .otp-digit {
            width: 50px;
            height: 50px;
            font-size: 24px;
            text-align: center;
            margin: 5px;
        }
        #verifyOTPBtn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }
    </style>
</head>
<body>
    <h2>Test OTP Auto-focus</h2>
    <div>
        <input type="text" maxlength="1" class="otp-digit" data-index="0" autocomplete="off">
        <input type="text" maxlength="1" class="otp-digit" data-index="1" autocomplete="off">
        <input type="text" maxlength="1" class="otp-digit" data-index="2" autocomplete="off">
        <input type="text" maxlength="1" class="otp-digit" data-index="3" autocomplete="off">
        <input type="text" maxlength="1" class="otp-digit" data-index="4" autocomplete="off">
        <input type="text" maxlength="1" class="otp-digit" data-index="5" autocomplete="off">
    </div>
    <br>
    <button id="verifyOTPBtn" disabled onclick="alert('Code: ' + getOTPCode())">Verify</button>
    <p id="status">Button is: <span id="buttonStatus">DISABLED</span></p>

    <script>
        function getOTPCode() {
            let otpCode = '';
            for (let i = 0; i < 6; i++) {
                const digit = document.querySelector(`.otp-digit[data-index="${i}"]`)?.value || '';
                otpCode += digit;
            }
            return otpCode;
        }
        
        function checkOTPComplete() {
            const otpCode = getOTPCode();
            const verifyBtn = document.getElementById('verifyOTPBtn');
            const status = document.getElementById('buttonStatus');
            if (verifyBtn) {
                verifyBtn.disabled = otpCode.length !== 6;
                status.textContent = verifyBtn.disabled ? 'DISABLED' : 'ENABLED';
                console.log('OTP Code:', otpCode, 'Length:', otpCode.length, 'Button disabled:', verifyBtn.disabled);
            }
        }

        document.addEventListener('DOMContentLoaded', function() {
            console.log('DOM Loaded - Setting up event listeners');
            
            // Handle OTP input auto-focus and validation
            document.addEventListener('input', function(e) {
                if (e.target.classList.contains('otp-digit')) {
                    console.log('Input event on otp-digit', e.target.dataset.index);
                    const index = parseInt(e.target.dataset.index);
                    let value = e.target.value;
                    
                    // Allow only digits
                    value = value.replace(/[^0-9]/g, '');
                    e.target.value = value;
                    
                    // Add filled class for styling
                    if (value) {
                        e.target.classList.add('filled');
                        
                        // Auto-focus next input
                        if (index < 5) {
                            const nextInput = document.querySelector(`.otp-digit[data-index="${index + 1}"]`);
                            if (nextInput) {
                                console.log('Focusing next input:', index + 1);
                                nextInput.focus();
                            }
                        }
                    } else {
                        e.target.classList.remove('filled');
                    }
                    
                    // Enable/disable verify button based on completion
                    checkOTPComplete();
                }
            });
            
            // Handle backspace navigation
            document.addEventListener('keydown', function(e) {
                if (e.target.classList.contains('otp-digit') && e.key === 'Backspace') {
                    const index = parseInt(e.target.dataset.index);
                    
                    if (!e.target.value && index > 0) {
                        // Move to previous input if current is empty
                        const prevInput = document.querySelector(`.otp-digit[data-index="${index - 1}"]`);
                        if (prevInput) {
                            console.log('Backspace - focusing previous input:', index - 1);
                            prevInput.focus();
                        }
                    }
                }
            });
            
            // Handle paste event
            document.addEventListener('paste', function(e) {
                if (e.target.classList.contains('otp-digit')) {
                    e.preventDefault();
                    const pastedData = e.clipboardData.getData('text').replace(/[^0-9]/g, '');
                    console.log('Pasted data:', pastedData);
                    
                    if (pastedData.length > 0) {
                        const startIndex = parseInt(e.target.dataset.index);
                        for (let i = 0; i < pastedData.length && (startIndex + i) < 6; i++) {
                            const input = document.querySelector(`.otp-digit[data-index="${startIndex + i}"]`);
                            if (input) {
                                input.value = pastedData[i];
                                input.classList.add('filled');
                            }
                        }
                        checkOTPComplete();
                    }
                }
            });
            
            console.log('All event listeners registered');
        });
    </script>
</body>
</html>
